<!-- Spinner and Title -->
<ngx-spinner type="ball-scale-multiple"></ngx-spinner>
<div style="margin-bottom: 20px; margin-top: 5px;">
    <p class="title">Catalogo de Clientes</p>
</div>

<!-- Flex Container for Side-by-Side Layout -->
<div class="tables-container" style="display: flex; width: 100%;">

    <!-- Clients Table -->
    <mat-card style="flex: 1; margin-right: 20px;">
        <mat-card-content>
            <p-table [value]="products" dataKey="id_client" [(selection)]="selectedClient" (onRowSelect)="onClientSelect($event)" selectionMode="single">
                <ng-template pTemplate="header">
                    <tr>
                        <th>Edit</th>
                        <th>ID</th>
                        <th>Client</th>
                        <th>Holding</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-rowData let-editing="editing" let-ri="rowIndex">
                    <tr [pSelectableRow]="rowData">
                        <td>
                            <button *ngIf="!rowData.editing" mat-icon-button matTooltip="Edit" (click)="toggleEdit(rowData, true)">
                                <mat-icon>edit</mat-icon>
                            </button>
                            <button *ngIf="rowData.editing" mat-icon-button matTooltip="Save" (click)="toggleEdit(rowData, false)">
                                <mat-icon>save</mat-icon>
                            </button>
                        </td>
                        <td>{{ rowData.id_client }}</td>
                        <td>{{ rowData.client }}</td>
                        <td>{{ rowData.holding }}</td>
                    </tr>
                </ng-template>
            </p-table>
        </mat-card-content>
    </mat-card>

    <!-- Plants Table -->
    <mat-card *ngIf="selectedClient" style="flex: 1;">
        <mat-card-title>Plants for {{ selectedClient.client }}</mat-card-title>
        <mat-card-content>
            <p-table [value]="plants">
                <ng-template pTemplate="header">
                    <tr>
                        <th>ID Plant</th>
                        <th>Name Plant</th>
                        <th>Start Contract</th>
                        <th>End Contract</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-plant let-editing="plant.editing">
                    <tr>
                        <td>{{ plant.id_plant }}</td>
                        <td>{{ plant.name_plant }}</td>
                        <td>{{ plant.inicio_contrato | date:'mediumDate' }}</td>
                        <td>{{ plant.fin_contrato | date:'mediumDate' }}</td>
                    </tr>
                </ng-template>
            </p-table>
        </mat-card-content>
    </mat-card>
</div>
