<ngx-spinner type="ball-scale-multiple"></ngx-spinner>

<div style="margin-bottom: 20px; margin-top: 5px;">
	<p class="title">{{title}}</p>
</div>

<mat-card>
	<mat-card-header fxLayout="row" fxLayout.xs="column">
	
	<div fxFlex="50" fxFlex.xs="100" fxLayout="column" fxLayoutAlign="center start" fxLayoutAlign.xs="center center">
		<mat-card-title>Basic Information</mat-card-title>
		<mat-card-subtitle>Please fill out all fields</mat-card-subtitle>
	</div>
	<div fxFlex="50" fxFlex.xs="100" fxLayoutAlign="end center" fxLayoutAlign.xs="center center">
		<button class="buttons button-create-list"  mat-raised-button color="accent" (click)="createList()">Create list</button>
	</div>
	
	
	</mat-card-header>
	<mat-card-content>
		<form [formGroup]="formFirstStep" novalidate>
			<div  fxLayoutAlign="space-around center">
				<div fxFlex="20">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>Fecha Trade</mat-label>
							<input matInput [matDatepicker]="picker1"  placeholder="Fecha 1" formControlName="trade_date"> 
							<mat-datepicker-toggle matSuffix [for]="picker1"></mat-datepicker-toggle>
							<mat-datepicker #picker1></mat-datepicker>
							<mat-error *ngIf="this.formFirstStep.get('trade_date')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>   
						</mat-form-field>
				</div>
				<div fxFlex="20">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>Trade type</mat-label>                                
						<mat-select formControlName="id_trade_type">                                
						<mat-option *ngFor="let t of listTradesType" [value]="t.id_type">
							{{t.trade_type}}
						</mat-option>
						</mat-select>  
						<mat-error *ngIf="this.formFirstStep.get('trade_type')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>
				</mat-form-field>			  
				</div>
				<div fxFlex="20">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>Bank</mat-label>                                
						<mat-select formControlName="id_bank">                                
						<mat-option *ngFor="let t of listBanks" [value]="t.id_bank">
							{{t.bank}}
						</mat-option>
						</mat-select>
						<mat-error *ngIf="this.formFirstStep.get('bank')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>            
				</mat-form-field>
				</div>
				<div fxFlex="20">
					<mat-form-field class="example-full-width" appearance="outline" style="width: 90%;">
						<mat-label>Trade ID</mat-label> 
						<input matInput placeholder="Trade ID" formControlName="id_trade">
						<mat-error *ngIf="this.formFirstStep.get('id_trade')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>
					</mat-form-field>
				</div>
				<div fxFlex="20">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>SAR</mat-label>                                
						<mat-select formControlName="id_sar">  
						<mat-option *ngFor="let t of listSars" [value]="t.id_sar">
							{{t.number_sar}}
						</mat-option>
						</mat-select>     
						<mat-error *ngIf="this.formFirstStep.get('id_sar')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>       
				</mat-form-field>
				</div>
			</div>

			<div>
				<div fxFlex="25">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>Period</mat-label>
						<mat-date-range-input [rangePicker]="picker">
						<input matStartDate  formControlName="fechaInicio">
						<input matEndDate  formControlName="fechaFin">
						</mat-date-range-input>					
						<mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
						<mat-date-range-picker #picker>
							<mat-date-range-picker-actions>
								<button mat-button matDateRangePickerCancel>Cancelar</button>
								<button mat-raised-button color="primary" matDateRangePickerApply>Aceptar</button>
								</mat-date-range-picker-actions>
						</mat-date-range-picker>					
					</mat-form-field>
				</div>
				<div fxFlex="25">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>Instrument</mat-label>                                
						<mat-select formControlName="id_instrument">                                
						<mat-option *ngFor="let t of listInstruments" [value]="t.id_instrument">
							{{t.instrument}}
						</mat-option>
						</mat-select>  
						<mat-error *ngIf="this.formFirstStep.get('id_instrument')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>          
				</mat-form-field>
				</div>
				<div fxFlex="25">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>Hedge Type</mat-label>                                
						<mat-select formControlName="id_hedge_type">
						<mat-option *ngFor="let t of listHedgeTypes" [value]="t.id_hedge_type">
							{{t.hedge_type}}
						</mat-option>
						</mat-select>    
						<mat-error *ngIf="this.formFirstStep.get('id_hedge_type')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>        
				</mat-form-field>
				</div>
				<div fxFlex="25">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>Index</mat-label>                                
						<mat-select formControlName="id_index">
						<mat-option *ngFor="let t of listIndexes" [value]="t.id_index">
							{{t.index_name}}
						</mat-option>
						</mat-select>
						<mat-error *ngIf="this.formFirstStep.get('id_index')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>       
				</mat-form-field>
				</div>			
			</div>

			<div>
				<div fxFlex="25">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>Volume basis</mat-label>                                
						<mat-select formControlName="id_volume_basis"> 
						<mat-option *ngFor="let t of listVolumeBasis" [value]="t.id_volume_basis">
							{{t.volume_basis}}
						</mat-option>
						</mat-select>
						<mat-error *ngIf="this.formFirstStep.get('id_volume_basis')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>      
				</mat-form-field>
				</div>
				<div fxFlex="25">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>Unit</mat-label>                                
						<mat-select formControlName="id_unit">           
						<mat-option *ngFor="let t of listUnits" [value]="t.id_unit">
							{{t.volume_unit}}
						</mat-option>
						</mat-select>
						<mat-error *ngIf="this.formFirstStep.get('id_unit')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>        
				</mat-form-field>
				</div>
				<div fxFlex="25">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>Currency</mat-label>                                
						<mat-select formControlName="id_currency">
						<mat-option *ngFor="let t of listCurrency" [value]="t.id_currency">
							{{t.currency_name}}
						</mat-option>
						</mat-select>
						<mat-error *ngIf="this.formFirstStep.get('id_currency')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>            
				</mat-form-field>
				</div>
				<div fxFlex="25">
					<mat-form-field appearance="outline" style="width: 90%;">
						<mat-label>Operation</mat-label>                                
						<mat-select formControlName="id_operation">
						<mat-option *ngFor="let t of listOperations" [value]="t.id_operation">
							{{t.operation_name}}
						</mat-option>
						</mat-select> 
						<mat-error *ngIf="this.formFirstStep.get('id_operation')?.hasError('required')">{{'Es necesario ingresar información'}}</mat-error>           
				</mat-form-field>
				</div>
			</div>
		</form>
		<!-- DIV DE LA LISTA -->
		<div class="div-table" fxLayout="column">
			<div fxFlex="100" fxLayout="row" fxLayoutAlign="space-between" style="margin-bottom: 10px;">
			<!-- <p class="title">List</p>-->				
				<div fxFlex="50" fxLayoutAlign="start center">
					<span class="title">List</span>
				</div>
				<div fxFlex="50" fxLayoutAlign="space-around center">
					<div style="font-size: 13px;">
						<mat-checkbox class="example-margin" [(ngModel)]="fill_down" >Fill down Daily/Monthly</mat-checkbox>
					</div>						
					<div style="font-size: 13px;">
						<mat-checkbox class="example-margin" [(ngModel)]="fill_down_price">Fill down Price</mat-checkbox>
					</div>	
				</div>												
			</div>
			<div>		
				 <p-table [value]="dataTable" dataKey="id" responsiveLayout="scroll">
					<ng-template pTemplate="header">
						<tr>
							<th>Date</th>
							<th>Volume Daily</th>
							<th>Volume Monthly</th>
							<th>Price</th>
						</tr>
					</ng-template>
					<ng-template pTemplate="body" let-product>
						<tr>
							<td>
								{{product.date | date}}
							</td>							
							<td pEditableColumn>
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="number" [(ngModel)]="product.vol_daily" (change)="updateVolume(product); fillDown(product, 'D')" (keydown.enter)="updateVolume(product); fillDown(product, 'D')">
									</ng-template>
									<ng-template pTemplate="output">
										{{product.vol_daily | number}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td pEditableColumn>
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText [(ngModel)]="product.vol_monthly" (change)="updateVolume(product); fillDown(product, 'M')" (keydown.enter)="updateVolume(product); fillDown(product, 'M')">
									</ng-template>
									<ng-template pTemplate="output">
										{{product.vol_monthly | number}}
									</ng-template>
								</p-cellEditor>
							</td>
							<td pEditableColumn>
								<p-cellEditor>
									<ng-template pTemplate="input">
										<input pInputText type="number" mode="currency" [(ngModel)]="product.price" (change)="fillDownPrice(product)" (keydown.enter)="fillDownPrice(product)">
									</ng-template>
									<ng-template pTemplate="output">
										{{product.price | currency: 'USD'}}
									</ng-template>
								</p-cellEditor>
							</td>
						</tr>
					</ng-template>
				</p-table>
			</div>
		</div>

		<!-- BUTTON -->
		<div style="margin-top:20px" fxLayoutAlign="end center">
			<button class="buttons" mat-raised-button color="primary" (click)="nextTable()">Next</button>
		</div>

	</mat-card-content>
</mat-card>